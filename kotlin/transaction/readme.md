## 코루틴에서 트랜잭션을 사용하는 방법

코루틴에서 트랜잭션을 적용하는 데 어려움을 겪는 케이스가 많다. 실제로 많이 어렵다고 알려져 있다.

Sprign I/O 2024 강연에서도 해당 내용이 나왔는데, 간단하고 오피셜하게 해결할 수 있는 방법을 알아보자.

## Why Problem

JPA의 Transaction에서는 ThreadLocal에 트랜잭션의 커넥션 정보를 저장한다.

이로 인해 여러가지 문제가 발생한다.

#### 1. Transactional 미동작




#### 2. 원하지 않는 범위의 롤백

문제는 코루틴 쓰레드는 1개의 요청만을 전담해서 처리하지 않는다.

코루틴의 쓰레드는 여러 요청의 Job을 수행하기 때문에 롤백될 때 원하지 않는 것들까지 롤백될 수 있다.





## 참고

- https://www.youtube.com/watch?v=FXHv8ROsc-o
