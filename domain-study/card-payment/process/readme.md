## 카드 결제

카드 결제에서는 세 가지 단계가 있다.
1. 인증
2. 승인
3. 매입
4. 정산

## 1. 인증

고객이 카드로 결제를 요청하면 처음으로 일어나는 게 인증이다. 결제할 카드 정보와 카드 소유자 정보가 맞는 지 확인한느 계정이다.
- 카드번호
- 유효기간
- CVC
- 생년월일
- 결제 비밀번호

비인증 결제도 있는데, 키인 결제(카드번호 결제)가 이에 속한다.

## 2. 승인

PG사는 VAN을 통해 카드사에 카드 승인을 요청한다. 카드사에는 해당 카드 정보, 고객 정보, 결제 정보를 전송한다.
- 체크, 선불은 카드사에서 돈이 빠져나갈 것이다.
- 신용카드에서는 카드의 한도만 차감된다.

## 3. 매입

매입은 PG사가 VAN을 통해 카드사에 승인된 결제 정보에 대한 정보를 알리는 과정이다.

가맹점이 서비스나 상품에 대한 대금을 정산받기 위해 필요하다.

매입을 하지 않으면 가맹점은 정산을 받을 수 없다. 

#### 매입이 필요한 이유

카드 결제 프로덕트를 개발하면 매입 프로세스가 왜 필요한 지를 이해하기 어려운 경우가 많다.

매입이 필요한 이유는 카드사도 결국 남의 돈을 빌려 회원 대신 돈을 내주는 것이기 때문이다.

매입이 없다면 실시간으로 모든 거래를 정산해야 하므로 데이터 처리와 금액 정산에서 혼란이 발생할 가능성이 매우 높고, 고객의 이의 제기에 대응하는 체계가 부족해질 수 있다. 정산이 완료된 거래를 되돌리는 과정은 매우 복잡하다.
추가로 거래 당마다 대금을 송금해야 하므로 송급 수수료나 처리 비용이 기하급수적으로 증가한다. 시스템 과부하가 생길 여지도 너무 크다.

글로벌 결제에서의 환율이 변동되는 문제도 있다.

## 4. 정산

정산은 PG사 -> 카드사 -> 각 가맹점 구조로 금액을 지급받는 과정을 말한다.
